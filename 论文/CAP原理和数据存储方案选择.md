Date: 2014-03-11  
Title: CAP原理和数据存储方案选择  
Published: true  
Type: post  
Excerpt:   # 一致性模型（Consistency）数据的一致性，一般来说有三种类型：弱一致性、最终一致性和强一致性。<!--当然，如果细分的话，还有很多一致性模型，如：顺序一致性、FIFO一致性、会话一致性，单读一致性，单写一致性等等。-->* 弱一致性（Weak）：当你写入一个新值后，读操作在数据副本上可能读出来，也可能读不出来。比如：某些Cache系统，VOIP系统，或是百度搜索引擎；  * 最终一致性（Eventually）：当你写入一个新值后，有可能读不出来，但在某个时间窗口之后保证最终能读出来。比如：DNS、电子邮件系统、Amazon S3、Google搜索引擎。* 强一致性（Strong）：新的数据一旦写入，在任意副本任意时刻都能读到新值。比如：文件系统、关系型数据库、Azure Table都是强一致性的。从这三种一致型的模型我们可以看到，弱一致性和最终一致性一般来说是异步冗余的，而强一致性一般来说是同步冗余的。需要注意的是，异步的通常意味着更好的性能，但也意味着更复杂的状态控制。同步意味着简单，但也意味着性能下降。## Master-Slave架构对于这种架构，Slave一般是Master的备份。在这样的系统中读写请求都由Master负责，写请求写到Master上后，由Master同步到Slave上。从Master同步到Slave上，你可以使用异步，也可以使用同步，可以使用Master来Push（例如触发器机制），也可以使用Slave来Pull。一般来说，我们会采用Slave来周期性的pull，所以，是最终一致性。这个设计的问题是，如果Master在pull周期内垮掉了，那么会导致这个时间片内的数据丢失。如果你不想让数据丢掉，Slave只能成为Read-Only的方式等Master恢复。