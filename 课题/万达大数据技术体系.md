万达大数据方案体系
======
Date: 2014-03-19  
Title: 大数据技术概述  
Published: true  
Type: post  
Excerpt:   

# 大数据技术概述

## 大数据特性



## 大数据思维

## 大数据技术的基础

## 目前主流的大数据解决方案：Hadoop

## 大数据技术与传统数据库的区别



# 万达大数据体系

## 技术架构

 <img src="image/万达大数据技术架构.png" width="800"/>
 
 万达大数据体系技术方案分为六个层级，我们封装了大数据领域绝大多数的业界产品方案：
 
 * 文件存储层：主要采用了HDFS和FastDFS作为分布式文件存储的基础构件，支持可靠存储TB到几十PB级别的大容量存储。
 * 数据存储层：基于文件存储层，提供关系型数据库、分布式列式数据库、图形数据库等不同类型的有序数据存储。
 * 计算层：资源基础调配采用下一代资源管理框架 Apache YARN 进行资源的分配和调度，同时提供Map-Reduce分布式计算框架、Spark内存计算框架和Storm流式计算框架等离线批处理计算任务。
 * 应用工具层：海量数据搜索应用，其中包括：数据爬虫（Crawler）、
 * 服务层：积累相应的
 * 数据集成层：Sqoop 支持从 DB 到 Hadoop 的数据迁移，CuteInfo支持不同类型的数据库之间的数据迁移；

### 文件存储层
 
#### HDFS

HDFS，Hadoop分布式文件系统，有着高容错性的特点，并且设计用来部署在低廉的硬件上，而且它提供高吞吐量来访问应用程序的数据，适合那些有着超大数据集的应用程序。HDFS放宽了POSIX的要求，这样可以实现流的形式访问文件系统中的数据。

#### FastDFS

### 数据存储层

#### 关系型数据库

我们支持符合JDBC规范的标准关系型数据库，

#### HBase 列式数据库

HBase（Hadoop Database）是一个高可靠性、高性能、面向列、可伸缩的分布式存储系统，利用HBase技术可在廉价PC Server上搭建起大规模结构化存储集群。HBase是Google Bigtable的开源实现，它利用Hadoop HDFS作为其文件存储系统，利用Hadoop MapReduce来处理HBase中的海量数据，以及利用Zookeeper作为协同服务。

#### Neo4J 图形数据库

### 计算层

#### Map-Reduce分布式计算框架

#### Spark内存计算方案

#### Strom流式计算方案


## 解决方案架构

 <img src="image/万达大数据解决方案架构.png" width="800"/>
 
 万达大数据解决方案如上图所示，主要包括以下各个部分：
 
 * 分布式（Hadoop）数据仓库：可以看做是Apache Hadoop的万达信息分发版，基于Apache Hadoop 2.2构建，为企业和政府部门实现大数据应用提供强有力的平台支持。万达在Hadoop上的改进和功能增强为用户提供了一个高性能、高稳定性和可管理的大数据应用实施平台，并提供全面的专业支持。
* 分布式内存分析引擎：
* 实时在线数据处理引擎：
* 实时流处理引擎：
 

### 分布式数据仓库

万达分布式数据仓库系统基于Apache Hadoop 2.2进行构建，定位是一个持续优化的具有企业级特性的Hadoop基础软件平台，定位于解决高并发、低响应、 TB级以上数据的存储和计算的需求，具备高可靠、低成本、按需扩容基础特性，并提供自动化部署、监控和告警、安全。

 <img src="image/分布式数据仓库.png" width="800"/>
 
#### 基本特性

大数据复杂分析和管理能力

* HBase 全文检索和准实时查询；
* 分布式R语言支持；

大数据平台管理能力

* 图形化安装配置  

#### 自动化部署、监控和运维

我们开发一个基于Web的工具，支持万达Hadoop集群的资源分配、管理和监控。目前已支持大多数Hadoop组件，包括HDFS、MapReduce、Hive、Pig、Hbase、Zookeper等等。提供企业级的自动部署、监控和运维能力，包括：

* 提供图形化管理界面对集群进行安装、配 置、部署、运行、监控和告警；
* 支持同时管理多个Hadoop/HBase集群，适应用户创建研发、测试、生产等多个集群并统一管理；
* 支持在同一个Hadoop 2.2集群上创建多个Hive、HBase、Map/Reduce集群，满足多部门/多用户的使用需求；

我们通过Ganglia收集Hadoop运行过程中的度量指标，用Nagios支持系统报警，当需要引起管理员的关注时（比如，节点停机或磁盘剩余空间不足等问题），系统将向其发送邮件。


### 分布式内存分析引擎

实时在线数据处理引擎提供大数据的交互式 SQL 统计和 R 语言挖掘能力。

 <img src="image/分布式内存分析数据库.png" width="600"/>

#### 主要特点

* 高性能：数据处理引擎支持将二维数据表缓存入独立的分布式内存（或SSD）中，建立列式存储、分区/分块和索引，采用改进后的Apache Spark作为执行引擎，SQL执行性能比Apache Hadoop + Hive的解决方案要提高10至100倍左右，性能超过主流MPP数据库2倍到10倍。数据处理引擎处理的数据不局限在内存中，即使数据在低速磁盘上SQL执行性能也比 Apache Hadoop/Hive 快5到20倍。
* 更强的SQL支持：数据处理引擎同时兼容Oracle PL-SQL和HiveQL语法，自动识别不同语法，支持存储过程和函数，支持常用Oracle扩展函数。完整的SQL支持帮助了用户平滑地从原有关系数据库迁移到大数据平台。
* 更强的统计分析能力：用户可以通过RStudio（R语言的IDE工具）或者R命令行访问存储在分布式内存中的数据，R语言中数千个统计算法可以和数据处理引擎提供的分布式并行数据挖掘算法交替混合使用，为各行业进行大数据挖掘提供了易用而强大的分析工具。
* 支持广泛的BI和报表工具：数据处理引擎可以和常用的BI工具对接，包括Tableau、SAP Business Objects、Oracle OBIEE等，用户无需编程就可以方便地为大数据创建美丽的报表，通过数据处理引擎提供的高速大数据统计分析能力提高决策效率；
* 高扩展能力：数据处理引擎可以随着集群规模的扩展，线性扩展处理能力，可以支持从GB到数百TB的数据处理。

#### 基本特性

分布式内存列式存储

* 独⽴立的分布式存储管理系统；
* 数据存放在Off Heap 内存，避免GC的影响；
* 充分利⽤用SSD作为Cache；
* 自定义列式存储格式，为内存和SSD优化；

高速SQL统计

* 性能⽐比Hadoop快10-100倍，⽐比MPP数据库快2-10倍，性能接近SAP HANA；
* 支持完整的HiveQL；
* 支持常见的Oracle扩展函数；
* 支持对HiveQL的多项重要性能和功能改进，包括⽀支持创建各种Filters、⽀支持对数据进⾏行灵活切分以避免shuffle；

高速R语⾔言统计

* 支持R语⾔言访问分布式内存数据（通过Hive）；
* 实现常见算法的并⾏行化版本，⽐比串⾏行版本快10倍；

支持多租户及经过验证的稳定版

* 可以运⾏在Hadoop 2.2和YARN上（TDH2.4）；
* 7x24⼩小时不间断运⾏，自动容错和故障修复；
* 动态不停机扩容；

### 实时在线数据处理引擎

多数据源的集中日益成为趋势, 当不同类型，来源的数据海量增长时，企业不仅需要收集更多的数据，更需要整合数据孤岛、将数据集中处理和分析做为决策流程的一部分。对于一些企业来说，要求数据的整合和分析并最终用于决策的时间非常短。随着内存数据库技术的发展，使得高速分析（包含复杂的迭代式或者交互式SQL分析）巨大而复杂的数据群成为可能。数据源以结构化数据为主，通常在GB到TB级，如政府各部门数据，证券交易，银行保险，零售业及旅游业的数据。

 <img src="image/实时在线数据处理引擎.png" width="600"/>
 
#### 主要特点

分布式内存数据库实时在线数据处理引擎以 Apache HBase为基础，是企业建立高并发的在线业务系统的最佳选择。

* 多种数据类型支持：支持从GB到几十PB数据的处理，支持广泛的数据类型，包括对结构化数据、半结构化文本、图数据、非结构化数据（图片 、音频、二进制文档等）的存储、搜索、统计和分析。
* 高速数据处理能力：支持高速的数据检索、搜索和统计；根据索引进行检索的延时在数毫秒到数百毫秒量级；支持上亿的并发用户同时进行数据插入、修改、查询和检索；支持对文本建立增量全文索引并且支持秒级的全文关键字搜索。
* 高效OLAP和批量统计：为分布式内存分析引擎提供高效数据扫描接口，扩展SQL语法，充分利用实时在线数据处理引擎的内部数据结构以及全局/辅助索引进行SQL执行加速，可以满足高速的OLAP数据分析应用需求；同时也支持高速的SQL离线批处理，性能接近于存储在HDFS上的相同数据的统计。
* 高效图计算：Hyperbase提供构造图形的API，帮助用户构造由上亿顶点组成的复杂大图，同时提供专有的高效图算法，包括关联网络的高速分析。f 

#### 基本特性

数据导⼊入⽅方式

* 使⽤HBASE API或Bulk Load进⾏行数据装载；
* 使⽤SQL INSERT INTO将Hive表数据插⼊入Hyperbase；
* 使⽤Sqoop将数据从RDB导⼊入Hyperbase；

数据统计⽅方式

* 支持边插⼊入数据边统计，⽀支持对实时数据的统计；
* 支持全量数据缓存在内存中进⾏行统计分析；
* 支持读取HBase内部接⼝（HFile等）, 批量对数据进⾏⾼速统计分析；
* 支持灵活运⽤结构化的HBase rowkey进⾏高效的表JOIN或GROUPBY, 避免Shuffle；
* 支持完整的HiveQL进⾏各种统计操作，包括各种SELECT, JOIN, GROUPBY, SUB-QUERY统计语句；

高效的索引

* 支持全⽂文索引，⽀支持关键字搜索（API⽅方式）；
* 支持全局索引（API⽅方式，最近会⽀支持SQL CREATE INDEX⽅方式，TDH 2.4）；

## 核心优势

### 极快的执行速度

分布式内存分析引擎采用专有的高效列式内存存储格式并基于为内存优化的Apache Spark计算引擎，相比广泛使用的原生的Map/Reduce框架消除了频繁的I/O磁盘访问。此外，Apache Spark引擎还采用了轻量级的调度框架和多线程计算模型，相比原生的Map/Reduce中的进程模型具有极低的调度和启动开销，除带来更快的执行速度以外，更使得系统的平均修复时间（MTTR）极大的缩短。

在实时在线应用方面，实时在线数据处理引擎构建了全局索引、辅助索引和全文索引等不同层级的索引机制，扩展了SQL语法，满足在线存储和在线业务分析系统（OLAP）的低延时需求。综合在执行引擎及数据存储层上的优化，使得整体解决方案比开源Apache Hadoop 2.2的执行速度快10倍到100倍，比主流MPP数据库快1.5x到10x。当数据全部装载到内存后，能在10秒内分析30亿条记录（500GB数据）。数据从10个节点的集群中测试获得。

### 超强的数据分析能力

万达大数据解决方案同时支持Oracle PL/SQL语法和完整的HiveQL语法，并对这些SQL语法进行了扩展，对执行计划进行了大量优化。更完整的SQL支持使得用户将原有数据分析应用方便地迁移到万达大数据解决方案平台，同时又能处理更大的数据量。将大数据放在数据分析师的手中，交互式地探索数据并发现业务模式和趋势，以便展开进一步的分析及决策已经变得越来越重要。
万达大数据解决方案通过分布式的内存列式存储和优化的高速执行引擎来支持交互式SQL查询，使得实时和交互式分析变成可能。我们同时支持R语言统计引擎，除了支持通过R访问HDFS或者HBase中的数据外，还支持访问存储在分布式内存中的数据。分布式内存分析引擎同时还内置了常用机器学习算法的并行化实现，可以与R语言中的数千个算法混合使用。我们支持R命令行以及R语言的IDE（RStudio）执行R语言程序来访问Hadoop中的数据，从而使得万达大数据解决方案成为在大数据的数据挖掘和可视化应用领域的利器。此外，万达大数据解决方案还集成了机器学习算法库 Mahout，包含了聚类分析、分类算法、频度关联分析和推荐系统在内的常用机器学习算法。

### 


## 我们的愿景

# 万达大数据实施案例

## 医疗卫生领域

### 基于万达大数据体系的医疗大数据平台
 <img src="image/医疗大数据分析集.png" width="800"/>

### 医疗大数据分析工具集

## 交通信息领域
（待补充）

## 社会保障领域
（待补充）



